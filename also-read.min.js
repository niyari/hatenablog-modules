/*
 HatenaBlog Also read (c) 2015 Pocket Systems. | psn.hatenablog.jp
 (・ω・) where to go? https://www.youtube.com/watch?v=nbeGeXgjh9Q
*/
(function(){function n(b,a){var c=[];$.ajax({dataType:"xml",url:a}).done(function(a,f,g){$(a).find("item").each(function(){c.push({title:$(this).find("title").text(),link:$(this).find("link").text()})});p(b,c)}).fail(function(a,c,b){})}function q(b,a){$.ajax({dataType:"jsonp",url:"http://b.hatena.ne.jp/entrylist/json",data:{sort:"count",url:a}}).done(function(a,e,f){p(b,a)}).fail(function(a,b,f){})}function r(){var b=[],a="body.page-entry div.entry-categories a";"touch"==document.getElementsByTagName("html")[0].dataset.device&&
(a="body.page-entry header.entry-header div.categories a");for(var a=document.querySelectorAll(a),c=0;c<a.length;c++){var e=a[c].href.split(u+"/archive/category/")[1];"undefined"!==typeof e&&b.push(e)}m=b;b=document.querySelectorAll(".js-htnpsne-awasete-module");for(a=0;a<b.length;a++){"true"==b[a].dataset.userCss&&(t=!1);var c=b[a],e=Math.random().toString(36).slice(6),h=document.createElement("div");h.dataset.targetId=e;c.dataset.targetId=e;var g="undefined"===typeof c.dataset.trackParameters?"":
' data-track-parameters="'+c.dataset.trackParameters+'"',d='<button class="js-htnpsne-awasete-btn-reload" data-target-id="'+e+'"><i class="blogicon-redirect"></i></button>';"true"==c.dataset.moreBtn&&(d+='<button class="js-htnpsne-awasete-btn-readmore" data-target-id="'+e+'"><i class="blogicon-list"></i></button>');"true"==c.dataset.subscribeBtn&&(d+='<button class="js-htnpsne-awasete-btn-subscribe" data-target-id="'+e+'"><i class="blogicon-subscribe"></i></button>');for(var k='<option value="" data-command="Popular">\u4eba\u6c17\u30a8\u30f3\u30c8\u30ea\u30fc</option><option value="" data-command="Recent">\u65b0\u7740\u30a8\u30f3\u30c8\u30ea\u30fc</option>',
l=0;l<m.length;l++)k+='<option value="'+m[l]+'">'+decodeURIComponent(m[l])+"</option>";h.innerHTML='<div class="js-htnpsne-awasete-control-outer"><span class="js-htnpsne-awasete-title">'+c.dataset.title+'</span><span class="js-htnpsne-awasete-control"><a href="http://psn.hatenablog.jp/" style="tipsy-top" id="Htn-psne-Awasete-Link-'+e+'" original-title="\u3059\u306a\u3070\u3044\u3058\u308a\u306b\u30a2\u30af\u30bb\u30b9" target="_blank">:)</a><select class="js-htnpsne-awasete-select" data-target-id="'+
e+'">'+k+"</select>"+d+'</span></div><div class="js-htnpsne-awasete-entrys" data-target-id="'+e+'" data-count="'+~~c.dataset.count+'"'+g+"> :) </div>";c.appendChild(h);c=b[a].dataset.mode;0==m.length&&(c="Recent");"Popular"==c?q(b[a].dataset.targetId,f):"Recent"==c?n(b[a].dataset.targetId,f+"/rss"):p(b[a].dataset.targetId,"Category",m[0]);$("#Htn-psne-Awasete-Link-"+b[a].dataset.targetId).tipsy({opacity:1})}v();t&&(b=document.createElement("link"),b.href="//niyari.github.io/hatenablog-modules/css/also-read.css",
b.rel="stylesheet",b.type="text/css",document.getElementsByTagName("head")[0].appendChild(b))}function p(b,a){var c=document.querySelectorAll('.js-htnpsne-awasete-entrys[data-target-id="'+b+'"]')[0],e=c.dataset.count,h="undefined"===typeof c.dataset.trackParameters?"":c.dataset.trackParameters;c.innerHTML="";0==a.length&&(a=[{link:f,title:"\u30d6\u30ed\u30b0TOP\u3078"}]);var g,d,k,l;g=a.slice();d=g.length;if(0!==d)for(;--d;)k=Math.floor(Math.random()*(d+1)),l=g[d],g[d]=g[k],g[k]=l;a=g;e>a.length?
e=a.length:0==e&&(e=3);for(g=0;g<e;g++)d=document.createElement("iframe"),d.className="embed-card embed-blogcard",d.style.display="block",d.style.width="100%",d.frameBorder=0,d.scrolling="no",d.title=a[g].title,d.src="http://hatenablog-parts.com/embed?url="+encodeURIComponent(a[g].link+h),c.appendChild(d)}function v(){for(var b=document.querySelectorAll(".js-htnpsne-awasete-select"),a=0;a<b.length;a++)"true"!=b[a].dataset.listen&&(b[a].dataset.listen="true",b[a].addEventListener("change",function(){var a=
this.dataset.targetId;if(""!=this.value)n(a,f+"/rss/category/"+this.value);else{var b=document.querySelectorAll('select[data-target-id="'+a+'"]')[0];"Popular"==b[b.selectedIndex].dataset.command?q(a,f):n(a,f+"/rss")}},!1));b=document.querySelectorAll(".js-htnpsne-awasete-btn-reload");for(a=0;a<b.length;a++)"true"!=b[a].dataset.listen&&(b[a].dataset.listen="true",b[a].addEventListener("click",function(){var a=this.dataset.targetId,b=document.querySelectorAll('select[data-target-id="'+a+'"]')[0];""!=
b.value?n(a,f+"/rss/category/"+document.querySelectorAll('select[data-target-id="'+a+'"]')[0].value):"Popular"==b[b.selectedIndex].dataset.command?q(a,f):n(a,f+"/rss")},!1));b=document.querySelectorAll(".js-htnpsne-awasete-btn-readmore");for(a=0;a<b.length;a++)"true"!=b[a].dataset.listen&&(b[a].dataset.listen="true",b[a].addEventListener("click",function(){var a=this.dataset.targetId,b=document.querySelectorAll('select[data-target-id="'+a+'"]')[0],h="",h=""!=b.value?f+"/archive/category/"+document.querySelectorAll('select[data-target-id="'+
a+'"]')[0].value:"Popular"==b[b.selectedIndex].dataset.command?"http://b.hatena.ne.jp/entrylist?sort=count&url="+encodeURIComponent(f):f+"/archive";window.open(h)},!1));b=document.querySelectorAll(".js-htnpsne-awasete-btn-subscribe");for(a=0;a<b.length;a++)"true"!=b[a].dataset.listen&&(b[a].dataset.listen="true",b[a].addEventListener("click",function(){var a=this.dataset.targetId,b=document.querySelectorAll('select[data-target-id="'+a+'"]')[0],h="",h=""!=b.value?f+"/rss/category/"+document.querySelectorAll('select[data-target-id="'+
a+'"]')[0].value:"Popular"==b[b.selectedIndex].dataset.command?"http://b.hatena.ne.jp/entrylist?sort=count&mode=rss&url="+encodeURIComponent(f):f+"/feed",a="http://cloud.feedly.com/#subscription%2Ffeed%2F"+encodeURIComponent(h);window.open(a)},!1))}var f=document.getElementsByTagName("html")[0].dataset.blogsUriBase,u=document.getElementsByTagName("html")[0].dataset.blog,t=!0,m=[];"uninitialized"==document.readyState||"loading"==document.readyState?window.addEventListener("DOMContentLoaded",function(){r()},
!1):r()})();